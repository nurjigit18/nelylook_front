{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///E:/nelylook/front/front_nely/app/%28auth%29/login/page.tsx"],"sourcesContent":["// app/account/page.tsx\r\nimport { redirect } from 'next/navigation';\r\nimport { cookies } from 'next/headers';\r\nimport ClientEditableCard from './ClientEditableCard';\r\n\r\ntype UserMe = {\r\n  id: number | string;\r\n  email: string;\r\n  first_name?: string | null;\r\n  last_name?: string | null;\r\n  phone?: string | null;\r\n  address?: string | null;\r\n};\r\n\r\nconst BACKEND_URL = process.env.BACKEND_URL || 'http://127.0.0.1:8000';\r\n\r\n// Fetch current user directly from server with cookies\r\nasync function getMe(): Promise<UserMe | null> {\r\n  try {\r\n    const cookieStore = cookies();\r\n    const accessToken = cookieStore.get('access_token')?.value;\r\n\r\n    console.log('üîç Account page - checking auth...');\r\n    console.log('üç™ Access token exists:', !!accessToken);\r\n\r\n    if (!accessToken) {\r\n      console.log('‚ùå No access token found in cookies');\r\n      return null;\r\n    }\r\n\r\n    console.log('üì° Fetching user from Django...');\r\n    const res = await fetch(`${BACKEND_URL}/auth/me/`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Authorization': `Bearer ${accessToken}`,\r\n        'Content-Type': 'application/json',\r\n      },\r\n      cache: 'no-store',\r\n    });\r\n\r\n    console.log('üì• Django response status:', res.status);\r\n\r\n    if (!res.ok) {\r\n      console.log('‚ùå Django returned error:', res.status);\r\n      return null;\r\n    }\r\n\r\n    const data = await res.json();\r\n    console.log('‚úÖ User fetched successfully:', data.email);\r\n    \r\n    return data as UserMe;\r\n  } catch (error) {\r\n    console.error('‚ùå Error fetching user:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default async function AccountPage() {\r\n  const me = await getMe();\r\n  \r\n  if (!me) {\r\n    redirect('/login?next=%2Faccount');\r\n  }\r\n\r\n  return (\r\n    <main className=\"mx-auto w-full max-w-6xl px-4 py-10\">\r\n      <div className=\"grid grid-cols-1 gap-8 md:grid-cols-[220px_1fr]\">\r\n        {/* Sidebar */}\r\n        <aside className=\"space-y-6\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-semibold tracking-tight\">\r\n              –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {me.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}\r\n            </h1>\r\n          </div>\r\n\r\n          <nav className=\"text-sm\">\r\n            <ul className=\"space-y-3\">\r\n              <li>\r\n                <span className=\"cursor-default text-black underline\">\r\n                  –õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\r\n                </span>\r\n              </li>\r\n              <li className=\"text-neutral-500 hover:text-black\">\r\n                <a href=\"/account/orders\">–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</a>\r\n              </li>\r\n              <li className=\"text-neutral-500 hover:text-black\">\r\n                <a href=\"/account/change-password\">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</a>\r\n              </li>\r\n            </ul>\r\n          </nav>\r\n\r\n          <div className=\"pt-4\">\r\n            <LogoutButton />\r\n          </div>\r\n        </aside>\r\n\r\n        {/* Content */}\r\n        <section className=\"rounded border border-neutral-300\">\r\n          <div className=\"p-6\">\r\n            <h2 className=\"text-sm font-semibold uppercase tracking-wide\">\r\n              –õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è\r\n            </h2>\r\n\r\n            <ClientEditableCard me={me} />\r\n          </div>\r\n        </section>\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n\r\nfunction LogoutButton() {\r\n  return (\r\n    <form action=\"/api/auth/logout\" method=\"POST\">\r\n      <button\r\n        type=\"submit\"\r\n        className=\"inline-flex items-center gap-2 text-sm text-neutral-600 hover:text-black\"\r\n      >\r\n        <span aria-hidden>‚Ü©</span> –í—ã–π—Ç–∏\r\n      </button>\r\n    </form>\r\n  );\r\n}"],"names":[],"mappings":"AAAA,uBAAuB;;;;;;AACvB;AAAA;AACA;;;;;;;;;;AAYA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAE/C,uDAAuD;AACvD,eAAe;IACb,IAAI;QACF,MAAM,cAAc,IAAA,wJAAO;QAC3B,MAAM,cAAc,YAAY,GAAG,CAAC,iBAAiB;QAErD,QAAQ,GAAG,CAAC;QACZ,QAAQ,GAAG,CAAC,2BAA2B,CAAC,CAAC;QAEzC,IAAI,CAAC,aAAa;YAChB,QAAQ,GAAG,CAAC;YACZ,OAAO;QACT;QAEA,QAAQ,GAAG,CAAC;QACZ,MAAM,MAAM,MAAM,MAAM,GAAG,YAAY,SAAS,CAAC,EAAE;YACjD,QAAQ;YACR,SAAS;gBACP,iBAAiB,CAAC,OAAO,EAAE,aAAa;gBACxC,gBAAgB;YAClB;YACA,OAAO;QACT;QAEA,QAAQ,GAAG,CAAC,8BAA8B,IAAI,MAAM;QAEpD,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,QAAQ,GAAG,CAAC,4BAA4B,IAAI,MAAM;YAClD,OAAO;QACT;QAEA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,QAAQ,GAAG,CAAC,gCAAgC,KAAK,KAAK;QAEtD,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO;IACT;AACF;AAEe,eAAe;IAC5B,MAAM,KAAK,MAAM;IAEjB,IAAI,CAAC,IAAI;QACP,IAAA,+MAAQ,EAAC;IACX;IAEA,qBACE,4PAAC;QAAK,WAAU;kBACd,cAAA,4PAAC;YAAI,WAAU;;8BAEb,4PAAC;oBAAM,WAAU;;sCACf,4PAAC;sCACC,cAAA,4PAAC;gCAAG,WAAU;;oCAAwC;oCACjC,GAAG,UAAU,IAAI;;;;;;;;;;;;sCAIxC,4PAAC;4BAAI,WAAU;sCACb,cAAA,4PAAC;gCAAG,WAAU;;kDACZ,4PAAC;kDACC,cAAA,4PAAC;4CAAK,WAAU;sDAAsC;;;;;;;;;;;kDAIxD,4PAAC;wCAAG,WAAU;kDACZ,cAAA,4PAAC;4CAAE,MAAK;sDAAkB;;;;;;;;;;;kDAE5B,4PAAC;wCAAG,WAAU;kDACZ,cAAA,4PAAC;4CAAE,MAAK;sDAA2B;;;;;;;;;;;;;;;;;;;;;;sCAKzC,4PAAC;4BAAI,WAAU;sCACb,cAAA,4PAAC;;;;;;;;;;;;;;;;8BAKL,4PAAC;oBAAQ,WAAU;8BACjB,cAAA,4PAAC;wBAAI,WAAU;;0CACb,4PAAC;gCAAG,WAAU;0CAAgD;;;;;;0CAI9D,4PAAC;gCAAmB,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMpC;AAEA,SAAS;IACP,qBACE,4PAAC;QAAK,QAAO;QAAmB,QAAO;kBACrC,cAAA,4PAAC;YACC,MAAK;YACL,WAAU;;8BAEV,4PAAC;oBAAK,aAAW;8BAAC;;;;;;gBAAQ;;;;;;;;;;;;AAIlC","debugId":null}}]
}